SELECT COUNT(DSERV.DEP_DLQ)
FROM (SELECT FCCS.DIM_CHILD_ID
FROM REPORTING.FACT_CASE_CHILD_STATUS FCCS
INNER JOIN REPORTING.DIM_STATUS DSTAT ON
FCCS.DIM_STATUS_ID = DSTAT.DIM_STATUS_ID
--WHERE FCCS.DIM_CHILD_ID = 5942
--AND DSTAT.STATUS_CD = 'CO') FCCSDSTAT
WHERE DSTAT.STATUS_CD = 'CO') FCCSDSTAT
INNER JOIN REPORTING.FACT_CHILD_SERVICE FCS ON
FCCSDSTAT.DIM_CHILD_ID = FCS.DIM_CHILD_ID
INNER JOIN REPORTING.DIM_SERVICE DSERV ON
FCS.DIM_SERVICE_ID = DSERV.DIM_SERVICE_ID;

select * from reporting.fact_child_service;


SELECT COUNT(FCCS.DIM_CHILD_ID)
FROM REPORTING.FACT_CASE_CHILD_STATUS FCCS
INNER JOIN REPORTING.FACT_CHILD_SERVICE FCS ON
FCCS.DIM_CHILD_ID = FCS.DIM_CHILD_ID; --11,014,718

SELECT *
FROM REPORTING.FACT_CASE_CHILD_STATUS FCCS
INNER JOIN REPORTING.FACT_CHILD_SERVICE FCS ON
FCCS.DIM_CHILD_ID = FCS.DIM_CHILD_ID
WHERE FCCS.DIM_CHILD_ID = 5942;

SELECT *
FROM REPORTING.FACT_CASE_CHILD_STATUS
--GROUP BY DIM_CHILD_ID
WHERE DIM_CHILD_ID = 9752;--16 COUNTS
/*
12/19/1994    12/19/1994 12:29:59 AM
12/19/1994 12:30:00 AM    12/19/1994 12:49:59 AM
11/1/2001    12/26/2001 12:59:59 AM
1/13/1999    2/3/1999 11:59:59 PM
5/20/1995    5/21/1995 11:59:59 PM
1/4/1995    2/19/1995 11:59:59 PM
2/4/1999    10/31/2001 11:59:59 PM
5/22/1995    1/12/1999 11:59:59 PM
2/20/1995    5/19/1995 11:59:59 PM
12/19/1994 12:50:00 AM    1/3/1995 11:59:59 PM
12/26/2001 1:00:00 AM    2/20/2004 12:29:59 AM
2/20/2004 12:30:00 AM    2/20/2004 12:49:59 AM
3/27/2004    6/10/2004 12:59:59 AM
2/20/2004 12:50:00 AM    3/24/2004 11:59:59 PM
3/25/2004    3/26/2004 11:59:59 PM
6/10/2004 1:00:00 AM    12/31/9999
*/

SELECT *
FROM REPORTING.FACT_CHILD_SERVICE
--GROUP BY DIM_CHILD_ID
WHERE DIM_CHILD_ID = 9752;--13 COUNTS
/*
3/25/1997    1/12/1999 11:59:59 PM
11/1/2000    4/30/2001 11:59:59 PM
5/1/2000    10/31/2000 11:59:59 PM
5/1/1999    4/30/2000 11:59:59 PM
3/25/2004    3/26/2004 11:59:59 PM
2/4/1999    4/30/1999 11:59:59 PM
5/1/2001    10/31/2001 11:59:59 PM
9/10/1996    3/24/1997 11:59:59 PM
5/8/1996    3/24/1997 11:59:59 PM
6/18/1995    5/7/1996 11:59:59 PM
5/22/1995    6/17/1995 11:59:59 PM
2/20/1995    5/19/1995 11:59:59 PM
12/19/1994 12:30:00 AM    1/3/1995 11:59:59 PM
*/


SELECT * 
FROM REPORTING.FACT_CASE_CHILD_STATUS FCCS
RIGHT JOIN REPORTING.FACT_CHILD_SERVICE FCS ON
FCCS.DIM_CHILD_ID = FCS.DIM_CHILD_ID
INNER JOIN REPORTING.DIM_STATUS DSTAT ON
DSTAT.DIM_STATUS_ID = FCCS.DIM_STATUS_ID
WHERE FCCS.DIM_CHILD_ID = 9752;
--AND DSTAT.STATUS_CD = 'CO';

select *
from reporting.fact_case_child_status;

select * from reporting.fact_child_service;

select fcs.dim_child_id from reporting.fact_child_service fcs
inner join reporting.dim_service dserv on
dserv.dim_service_id = fcs.dim_service_id
where serv_cd like '_1%';

select * from reporting.dim_service where dep_dlq = 'DEP';

select * from reporting.fact_shared_child where end_dt <> to_date('12/31/9999', 'mm/dd/yyyy');--298719

select count(*) from reporting.fact_shared_child--300861




/*
select 
from reporting.fact_case_child_status fccs
inner join REPORTING.DIM_STATUS dstat on
fccs.dim_status_id = dstat.dim_status_id
*/